define(['jquery','matchMedia'],function($,mediaCheck){'use strict';return function(originalWidget){$.widget('ox.OxMegaMenu',originalWidget,{_create:function(){var _self=this,$ox_megamenu=this.element,$ox_megamenu__dropdown=$ox_megamenu.find(this.options.classDropdown),$ox_megamenu__submenu=$ox_megamenu__dropdown.find('.ox-submenu');this.ps=$ox_megamenu.hasClass('ps-enabled');this.currentlyOpened=null;this.ox_megamenu__navigation=$ox_megamenu.find(this.options.classNavigation);mediaCheck({media:'(min-width:'+this.options.mediaBreakpoint+'px)',entry:$.proxy(function(){this._toggleDesktopMode();},this),exit:$.proxy(function(){this._toggleMobileMode();},this),});this._setActiveMenu();var $window=$(window);this._windowWidth=$window.innerWidth();var $megamenuSubmenu=$ox_megamenu__submenu.parent('li');var $megamenuWrap=$ox_megamenu.find('li.parent > .ox-mm-a-wrap, li.ox-dropdown--megamenu > .ox-mm-a-wrap');var isDesktop=_self.is_desktop;var megamenuEvents={'mouseenter':function(){_self._showMM(this);if(typeof amlazycallback!=='undefined'){amlazycallback();}},'mouseleave':function(){_self._hideMM(this);if(typeof amlazycallback!=='undefined'){amlazycallback();}},'touchstart':function(e){if($(this).hasClass('ox-megamenu--opened')||($(this).find('> a').data('url')==='custom'&&!$(this).hasClass('parent'))){return;}
if(typeof amlazycallback!=='undefined'){amlazycallback();}
e.preventDefault();_self._showMM(this);}};var submenuEvents={'mouseenter':function(){_self._showDD(this);if(typeof amlazycallback!=='undefined'){amlazycallback();}},'mouseleave':function(){_self._hideDD(this);if(typeof amlazycallback!=='undefined'){amlazycallback();}},'touchstart':function(e){if($(this).hasClass('js-touch')){return;}
if(typeof amlazycallback!=='undefined'){amlazycallback();}
$(this).addClass('js-touch');e.preventDefault();_self._showDD(this);}};var wrapEvents={'click':function(e){if((e.target.tagName==='A'||e.target.tagName==='SPAN')&&$(e.target).parent().closest('li').eq(0).hasClass('ox-megamenu--opened')||!$(e.target).closest('li').eq(0).find('.submenu, .ox-submenu, .ox-megamenu__dropdown').length){return;}
_self._toggleList(this);e.preventDefault();return false;}};function updateEventHandlers(isDesktop){if(isDesktop){_self.ox_megamenu__navigation.on(megamenuEvents,'>li, li.ox-dropdown--megamenu');$megamenuSubmenu.on(submenuEvents);$megamenuWrap.off('click').removeClass('js-touch');$megamenuSubmenu.removeAttr('style');}else{_self.ox_megamenu__navigation.off(megamenuEvents);$megamenuSubmenu.off(submenuEvents);$megamenuWrap.on(wrapEvents);}}
updateEventHandlers(isDesktop);$window.on('resize.handlerswidth oxMenuToggleMode',debounce(function(){let newIsDesktop=_self.is_desktop,newWindowWidth=$window.innerWidth();if(newIsDesktop!==isDesktop){isDesktop=newIsDesktop;updateEventHandlers(isDesktop);}
if(newWindowWidth!==_self._windowWidth){_self._windowWidth=newWindowWidth;$ox_megamenu__dropdown.removeAttr('style');}},200));function debounce(func,wait){var timeout;return function(){clearTimeout(timeout);timeout=setTimeout(func,wait);};}
$(this.window).trigger('resize');},});return $.ox.OxMegaMenu;};});